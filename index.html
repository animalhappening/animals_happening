<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport"
  content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="theme-color" content="#0b1220">
<meta name="format-detection" content="telephone=no,email=no,address=no">
<title>AI診断｜あなたに最適なAIは？</title>

<style>
:root{
  --bg:#070b14;
  --panel:#0b1220;
  --text:#e7eefc;
  --muted:#a9b7d6;
  --accent:#7c3aed;
  --good:#22c55e;
  --line:rgba(255,255,255,.12);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,"Noto Sans JP","Meiryo",sans-serif;
  background:var(--bg);
  color:var(--text);
}
.page{display:none;min-height:100vh;padding:18px}
.page.active{display:block}

h1{font-size:22px;margin:0 0 12px}
h2{font-size:18px;margin:0 0 10px}
p{color:var(--muted)}

.card{
  background:rgba(255,255,255,.04);
  border:1px solid var(--line);
  border-radius:16px;
  padding:16px;
  margin-bottom:14px;
}

.opt{
  border:1px solid var(--line);
  border-radius:14px;
  padding:12px;
  margin-bottom:10px;
  cursor:pointer;
}
.opt.sel{
  border-color:var(--accent);
  background:rgba(124,58,237,.18);
}

.btn{
  width:100%;
  border:none;
  border-radius:999px;
  padding:14px;
  font-size:15px;
  background:var(--accent);
  color:white;
  cursor:pointer;
}
.btn.secondary{
  background:transparent;
  border:1px solid var(--line);
  color:var(--text);
}

.result{
  border:1px solid var(--line);
  border-radius:16px;
  padding:14px;
  margin-bottom:12px;
}
.score{
  font-size:22px;
  font-weight:bold;
  color:var(--good);
}

footer{
  text-align:center;
  font-size:12px;
  color:var(--muted);
  margin-top:24px;
}
</style>
</head>

<body>

<!-- ================= 診断画面 ================= -->
<div id="page-quiz" class="page active">
  <h1>AI診断</h1>
  <p>質問に答えるだけで、あなたに最適なAIを判定します。</p>

  <div class="card">
    <h2>Q1. 何をしたい？</h2>
    <div class="opt" data-q="goal" data-v="writing">文章・要約・企画</div>
    <div class="opt" data-q="goal" data-v="image">画像生成</div>
    <div class="opt" data-q="goal" data-v="video">動画生成</div>
    <div class="opt" data-q="goal" data-v="coding">プログラミング</div>
  </div>

  <div class="card">
    <h2>Q2. 日本語の自然さは？</h2>
    <div class="opt" data-q="jp" data-v="must">必須</div>
    <div class="opt" data-q="jp" data-v="ok">どちらでも</div>
  </div>

  <div class="card">
    <h2>Q3. 料金</h2>
    <div class="opt" data-q="cost" data-v="free">無料がいい</div>
    <div class="opt" data-q="cost" data-v="paid">有料OK</div>
  </div>

  <button class="btn" id="btnDiagnose">診断する</button>

  <footer>ver 1.0 / TWA optimized</footer>
</div>

<!-- ================= 結果画面 ================= -->
<div id="page-result" class="page">
  <h1>診断結果</h1>

  <div id="results"></div>

  <button class="btn secondary" onclick="goPage('quiz')">
    ← 診断に戻る
  </button>
</div>

<script>
/* ================= 状態 ================= */
const answers = {};

/* ================= 画面遷移 ================= */
function goPage(page){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById("page-"+page).classList.add("active");
  history.pushState({page}, "", "#"+page);
}

window.addEventListener("popstate", e=>{
  const page = e.state?.page || "quiz";
  goPage(page);
});

history.replaceState({page:"quiz"},"","#quiz");

/* ================= 選択UI ================= */
document.querySelectorAll(".opt").forEach(opt=>{
  opt.onclick=()=>{
    const q=opt.dataset.q;
    const v=opt.dataset.v;
    answers[q]=v;
    document.querySelectorAll(`.opt[data-q="${q}"]`)
      .forEach(o=>o.classList.remove("sel"));
    opt.classList.add("sel");
  };
});

/* ================= 判定ロジック ================= */
function diagnose(){
  const score={
    chatgpt:0,
    dalle:0,
    runway:0,
    copilot:0
  };

  if(answers.goal==="writing") score.chatgpt+=30;
  if(answers.goal==="image") score.dalle+=30;
  if(answers.goal==="video") score.runway+=30;
  if(answers.goal==="coding") score.copilot+=30;

  if(answers.jp==="must") score.chatgpt+=10;
  if(answers.cost==="free") score.chatgpt+=5;

  return Object.entries(score)
    .sort((a,b)=>b[1]-a[1])
    .slice(0,3);
}

/* ================= 結果描画 ================= */
function renderResults(){
  const res=diagnose();
  const el=document.getElementById("results");
  el.innerHTML="";

  res.forEach(([id,sc],i)=>{
    el.innerHTML+=`
      <div class="result">
        <div><strong>#${i+1} ${id.toUpperCase()}</strong></div>
        <div class="score">${sc}</div>
        <p>あなたの条件に合致しています。</p>
      </div>
    `;
  });
}

/* ================= 診断ボタン ================= */
document.getElementById("btnDiagnose").onclick=()=>{
  if(Object.keys(answers).length<3){
    alert("すべて回答してください");
    return;
  }
  renderResults();
  goPage("result");
};

/* ================= 外部リンク制御（TWA） ================= */
document.addEventListener("click",e=>{
  const a=e.target.closest("a");
  if(a && a.href.startsWith("http")){
    e.preventDefault();
    window.open(a.href,"_blank");
  }
});
</script>
</body>
</html>
