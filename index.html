<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1" />
  <meta name="theme-color" content="#0b1220" />
  <meta name="format-detection" content="telephone=no,email=no,address=no" />

  <title>AIè¨ºæ–­ï½œã“ã®æ‚©ã¿ã«æœ€é©ãªAIã¯ï¼Ÿï¼ˆç„¡æ–™ï¼‰</title>
  <meta name="description" content="è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€æ–‡ç« ãƒ»ç”»åƒãƒ»å‹•ç”»ãƒ»ã‚³ãƒ¼ãƒ‰ãƒ»è‡ªå‹•åŒ–ãªã©ç”¨é€”ã«æœ€é©ãªAIã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚" />

  <!-- â˜… PWA / TWA -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <!-- OGPï¼ˆâ˜…çµ¶å¯¾URLï¼‰ -->
  <meta property="og:title" content="AIè¨ºæ–­ï½œã“ã®æ‚©ã¿ã«æœ€é©ãªAIã¯ï¼Ÿ" />
  <meta property="og:description" content="è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€ã‚ãªãŸã«åˆã†AIãŒã‚ã‹ã‚‹ã€‚" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://your-domain.example/" />
  <meta property="og:image" content="https://your-domain.example/icon/icon-512.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- JSON-LD -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"AIè¨ºæ–­",
    "operatingSystem":"Android",
    "applicationCategory":"UtilitiesApplication",
    "inLanguage":"ja"
  }
  </script>

  <style>
    :root{
      --bg:#070b14;
      --panel:#0b1220;
      --panel2:#0f1a2e;
      --text:#e7eefc;
      --muted:#a9b7d6;
      --line:rgba(231,238,252,.12);
      --accent:#7c3aed;
      --accent2:#22c55e;
      --warn:#f59e0b;
      --danger:#ef4444;
      --shadow: 0 18px 60px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:26px;
      --max:1040px;
      --focus: 0 0 0 3px rgba(124,58,237,.35);
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN","Noto Sans JP","Meiryo", Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1100px 600px at 20% -10%, rgba(124,58,237,.35), transparent 60%),
        radial-gradient(900px 500px at 90% 0%, rgba(34,197,94,.22), transparent 55%),
        radial-gradient(900px 650px at 40% 110%, rgba(59,130,246,.18), transparent 55%),
        var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    a{color:inherit}
    .wrap{max-width:var(--max); margin:0 auto; padding:28px 18px 80px}
    header{
      display:flex; align-items:flex-start; justify-content:space-between; gap:16px;
      margin:10px 0 22px;
    }
    .brand{
      display:flex; gap:14px; align-items:center;
    }
    .logo{
      width:44px; height:44px; border-radius:14px;
      background: linear-gradient(145deg, rgba(124,58,237,.95), rgba(34,197,94,.85));
      box-shadow: 0 10px 30px rgba(124,58,237,.25);
      display:grid; place-items:center;
      position:relative;
      overflow:hidden;
    }
    .logo::after{
      content:"";
      position:absolute; inset:-40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.28), transparent 55%);
      transform: rotate(12deg);
    }
    .logo span{
      position:relative;
      font-weight:900;
      letter-spacing:.02em;
    }
    .title h1{
      margin:0;
      font-size: clamp(20px, 3.4vw, 32px);
      letter-spacing:.01em;
    }
    .title p{
      margin:8px 0 0;
      color:var(--muted);
      max-width: 62ch;
      font-size: 14px;
    }
    .top-actions{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;
    }
    .btn{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--text);
      padding:10px 12px;
      border-radius: 999px;
      cursor:pointer;
      display:inline-flex; align-items:center; gap:8px;
      transition: transform .05s ease, background .15s ease, border-color .15s ease;
      user-select:none;
      text-decoration:none;
      font-size: 13px;
    }
    .btn:hover{background: rgba(255,255,255,.07); border-color: rgba(231,238,252,.20)}
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      background: linear-gradient(145deg, rgba(124,58,237,.95), rgba(124,58,237,.75));
      border-color: rgba(124,58,237,.55);
      box-shadow: 0 14px 38px rgba(124,58,237,.24);
    }
    .btn.primary:hover{background: linear-gradient(145deg, rgba(124,58,237,1), rgba(124,58,237,.82))}
    .btn.good{
      background: linear-gradient(145deg, rgba(34,197,94,.95), rgba(34,197,94,.75));
      border-color: rgba(34,197,94,.55);
      box-shadow: 0 14px 38px rgba(34,197,94,.18);
    }
    .btn.ghost{background:transparent}
    .btn:focus-visible{outline:none; box-shadow: var(--focus)}
    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
      .top-actions{justify-content:flex-start}
    }

    .card{
      background: rgba(255,255,255,.03);
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:16px 16px 12px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), transparent);
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .card .hd h2{
      margin:0;
      font-size: 16px;
      letter-spacing:.01em;
    }
    .card .hd .mini{
      color:var(--muted);
      font-size:12px;
    }
    .card .bd{padding:16px}
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 10px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 999px;
      font-size: 12px;
      color: var(--muted);
    }
    .dot{width:8px; height:8px; border-radius:99px; background: var(--accent)}
    .dot.g{background: var(--accent2)}
    .dot.w{background: var(--warn)}
    .dot.r{background: var(--danger)}

    .stepper{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }
    .progress{
      flex:1;
      height:10px;
      border-radius:999px;
      background: rgba(231,238,252,.08);
      overflow:hidden;
      border: 1px solid rgba(231,238,252,.10);
      min-width: 160px;
    }
    .progress > div{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(124,58,237,1), rgba(34,197,94,1));
      border-radius:999px;
      transition: width .25s ease;
    }

    .qwrap{display:grid; gap:14px}
    .q{
      padding:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
      border-radius: var(--radius);
    }
    .q .label{
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      margin-bottom:10px;
    }
    .q .label strong{font-size:14px}
    .q .label span{color:var(--muted); font-size:12px}
    .options{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:10px;
    }
    @media (max-width: 540px){
      .options{grid-template-columns:1fr}
    }
    .opt{
      border:1px solid rgba(231,238,252,.14);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      padding:12px;
      cursor:pointer;
      display:flex; align-items:flex-start; gap:10px;
      transition: background .15s ease, border-color .15s ease, transform .05s ease;
      position:relative;
      min-height: 58px;
    }
    .opt:hover{background: rgba(255,255,255,.06); border-color: rgba(231,238,252,.22)}
    .opt:active{transform: translateY(1px)}
    .opt input{position:absolute; opacity:0; pointer-events:none}
    .opt .mark{
      width:18px; height:18px; border-radius: 6px;
      border: 1px solid rgba(231,238,252,.25);
      background: rgba(255,255,255,.02);
      margin-top:2px;
      display:grid; place-items:center;
      flex:0 0 auto;
    }
    .opt .mark::after{
      content:"";
      width:10px; height:10px; border-radius: 4px;
      background: transparent;
      transition: background .15s ease;
    }
    .opt .txt{display:grid; gap:2px}
    .opt .txt b{font-size:13px}
    .opt .txt small{font-size:12px; color:var(--muted)}
    .opt.sel{
      border-color: rgba(124,58,237,.55);
      background: rgba(124,58,237,.14);
    }
    .opt.sel .mark{border-color: rgba(124,58,237,.65)}
    .opt.sel .mark::after{background: rgba(124,58,237,1)}
    .opt:focus-visible{outline:none; box-shadow: var(--focus)}

    .controls{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      margin-top: 12px;
    }
    .controls .left, .controls .right{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    .hint{
      font-size: 12px;
      color: var(--muted);
    }

    .results{display:grid; gap:12px}
    .resCard{
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
      border-radius: var(--radius2);
      overflow:hidden;
    }
    .resCard .top{
      padding:14px 14px 12px;
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .resCard .top .name{
      display:grid; gap:4px;
    }
    .resCard .top .name strong{
      font-size: 15px;
      letter-spacing:.01em;
    }
    .chips{display:flex; gap:8px; flex-wrap:wrap; margin-top:6px}
    .chip{
      font-size: 12px;
      color: var(--muted);
      border:1px solid rgba(231,238,252,.14);
      background: rgba(255,255,255,.03);
      padding:6px 9px;
      border-radius:999px;
    }
    .score{
      text-align:right;
      min-width: 88px;
    }
    .score .n{
      font-weight:800;
      font-size: 18px;
    }
    .score .sub{
      font-size: 12px;
      color: var(--muted);
      margin-top:2px;
    }
    .resCard .mid{
      padding:12px 14px 14px;
      display:grid; gap:10px;
    }
    .kvs{
      display:grid; gap:8px;
      grid-template-columns: 1fr;
    }
    .kv{
      padding:10px 11px;
      border:1px solid rgba(231,238,252,.12);
      background: rgba(255,255,255,.02);
      border-radius: 14px;
    }
    .kv b{font-size:13px}
    .kv p{margin:6px 0 0; font-size:13px; color:var(--text)}
    .kv p.muted{color:var(--muted)}
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-size: 12px;
      line-height: 1.5;
      background: rgba(0,0,0,.30);
      border: 1px solid rgba(231,238,252,.12);
      border-radius: 14px;
      padding: 10px 11px;
      overflow:auto;
      white-space: pre-wrap;
      word-break: break-word;
    }
    details{
      border:1px solid rgba(231,238,252,.12);
      border-radius: 14px;
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    summary{
      cursor:pointer;
      padding:12px 12px;
      font-size: 13px;
      color: var(--muted);
      list-style:none;
      user-select:none;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
    }
    summary::-webkit-details-marker{display:none}
    details[open] summary{border-bottom:1px solid rgba(231,238,252,.10)}
    .detailsBody{padding: 12px}
    .footer{
      margin-top: 18px;
      color: var(--muted);
      font-size: 12px;
      display:flex; gap:10px; justify-content:space-between; flex-wrap:wrap;
    }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%);
      background: rgba(15,26,46,.92);
      border: 1px solid rgba(231,238,252,.16);
      border-radius: 999px;
      padding: 10px 12px;
      color: var(--text);
      font-size: 13px;
      box-shadow: var(--shadow);
      display:none;
      z-index: 99;
      backdrop-filter: blur(10px);
    }

    .muted{color:var(--muted)}
    .small{font-size:12px}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .sr-only{
      position:absolute; width:1px; height:1px; padding:0; margin:-1px;
      overflow:hidden; clip:rect(0,0,0,0); border:0;
    }
    .divider{
      height:1px; background: rgba(231,238,252,.10);
      margin: 12px 0;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"><span>AI</span></div>
        <div class="title">
          <h1>AIè¨ºæ–­ï¼šã“ã®æ‚©ã¿ã«æœ€é©ãªAIã¯ï¼Ÿ</h1>
          <p>
            è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€ã‚ãªãŸã®ç›®çš„ã«åˆã†AIã‚’ãŠã™ã™ã‚ã—ã¾ã™ï¼ˆæ–‡ç« ãƒ»ç”»åƒãƒ»å‹•ç”»ãƒ»ã‚³ãƒ¼ãƒ‰ãƒ»è‡ªå‹•åŒ–ãªã©ï¼‰ã€‚
            <span class="muted">â€»ã“ã®ãƒšãƒ¼ã‚¸ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Œçµã€‚APIã‚­ãƒ¼ä¸è¦ã€‚</span>
          </p>
        </div>
      </div>

      <div class="top-actions">
        <button class="btn ghost" id="btnLoadSample" type="button" title="ä¾‹ã®å›ç­”ã‚’è‡ªå‹•å…¥åŠ›">
          ä¾‹ã§è©¦ã™
        </button>
        <button class="btn" id="btnReset" type="button" title="å›ç­”ã‚’ãƒªã‚»ãƒƒãƒˆ">
          ãƒªã‚»ãƒƒãƒˆ
        </button>
        <a class="btn primary" href="#diagnosis" title="è¨ºæ–­ã¸">
          è¨ºæ–­ã™ã‚‹
        </a>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT: Diagnostic -->
      <section class="card" id="diagnosis" aria-label="AIè¨ºæ–­">
        <div class="hd">
          <div style="display:grid; gap:6px">
            <h2>è¨ºæ–­ï¼ˆ5å•ï¼‰</h2>
            <div class="stepper">
              <span class="badge" id="stepBadge"><span class="dot"></span>æœªå›ç­”</span>
              <div class="progress" aria-label="é€²æ—"><div id="progBar"></div></div>
              <span class="mini" id="progText">0 / 5</span>
            </div>
          </div>
          <span class="badge"><span class="dot g"></span>æœ€çŸ­30ç§’</span>
        </div>

        <div class="bd">
          <form id="quiz" class="qwrap" autocomplete="off">
            <!-- Q1 -->
            <div class="q" data-q="goal">
              <div class="label">
                <strong>Q1. ä½•ã‚’ã—ãŸã„ï¼Ÿ</strong>
                <span>å¿…é ˆ</span>
              </div>
              <div class="options" role="radiogroup" aria-label="ä½•ã‚’ã—ãŸã„ï¼Ÿ">
                <label class="opt" tabindex="0">
                  <input type="radio" name="goal" value="writing" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>æ–‡ç« ãƒ»è¦ç´„ãƒ»ãƒ¡ãƒ¼ãƒ«</b>
                    <small>ãƒ–ãƒ­ã‚°ã€ä¼ç”»ã€è­°äº‹éŒ²ã€ç¿»è¨³</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="goal" value="image" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ç”»åƒç”Ÿæˆãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³</b>
                    <small>ã‚¢ã‚¤ã‚³ãƒ³ã€ã‚µãƒ ãƒã€ç´ æ</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="goal" value="video" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>å‹•ç”»ç”Ÿæˆ</b>
                    <small>ã‚·ãƒ§ãƒ¼ãƒˆã€PVã€ã‚¢ãƒ‹ãƒ¡é¢¨</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="goal" value="coding" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ»é–‹ç™º</b>
                    <small>Web/ã‚¢ãƒ—ãƒª/è‡ªå‹•åŒ–/ãƒ‡ãƒãƒƒã‚°</small>
                  </span>
                </label>
              </div>
            </div>

            <!-- Q2 -->
            <div class="q" data-q="level">
              <div class="label">
                <strong>Q2. ã‚ãªãŸã®ãƒ¬ãƒ™ãƒ«ã¯ï¼Ÿ</strong>
                <span>å¿…é ˆ</span>
              </div>
              <div class="options" role="radiogroup" aria-label="ãƒ¬ãƒ™ãƒ«">
                <label class="opt" tabindex="0">
                  <input type="radio" name="level" value="beginner" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>åˆå¿ƒè€…</b>
                    <small>ã¾ãšã¯ç°¡å˜ã«ä½¿ã„ãŸã„</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="level" value="intermediate" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ä¸­ç´š</b>
                    <small>è¨­å®šã‚„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚‚å°‘ã—è§¦ã‚Œã‚‹</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="level" value="advanced" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ä¸Šç´š</b>
                    <small>APIã‚„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚‚OK</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="level" value="any" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ã“ã ã‚ã‚‰ãªã„</b>
                    <small>ãŠã™ã™ã‚å„ªå…ˆ</small>
                  </span>
                </label>
              </div>
            </div>

            <!-- Q3 -->
            <div class="q" data-q="jp">
              <div class="label">
                <strong>Q3. æ—¥æœ¬èªã®è‡ªç„¶ã•ã¯ã©ã‚Œãã‚‰ã„é‡è¦ï¼Ÿ</strong>
                <span>å¿…é ˆ</span>
              </div>
              <div class="options" role="radiogroup" aria-label="æ—¥æœ¬èªã®é‡è¦åº¦">
                <label class="opt" tabindex="0">
                  <input type="radio" name="jp" value="must" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>å¿…é ˆï¼ˆè¶…é‡è¦ï¼‰</b>
                    <small>è‡ªç„¶ãªæ•¬èªãƒ»è¨€ã„å›ã—ãŒå¤§äº‹</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="jp" value="nice" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ã§ãã‚Œã°</b>
                    <small>å¤šå°‘ã®é•å’Œæ„Ÿã¯OK</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="jp" value="ok" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ã©ã¡ã‚‰ã§ã‚‚</b>
                    <small>è‹±èªã§ã‚‚å¤§ä¸ˆå¤«</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="jp" value="none" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>æ°—ã«ã—ãªã„</b>
                    <small>çµæœãŒå‡ºã‚Œã°OK</small>
                  </span>
                </label>
              </div>
            </div>

            <!-- Q4 -->
            <div class="q" data-q="budget">
              <div class="label">
                <strong>Q4. æ–™é‡‘ã®å¸Œæœ›ã¯ï¼Ÿ</strong>
                <span>å¿…é ˆ</span>
              </div>
              <div class="options" role="radiogroup" aria-label="æ–™é‡‘ã®å¸Œæœ›">
                <label class="opt" tabindex="0">
                  <input type="radio" name="budget" value="free" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ç„¡æ–™ã ã‘</b>
                    <small>ã§ãã‚‹ç¯„å›²ã§OK</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="budget" value="low" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>å®‰ã‚ãªã‚‰OK</b>
                    <small>æœˆæ•°ç™¾ã€œåƒå††ãã‚‰ã„</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="budget" value="ok" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>æœ‰æ–™OK</b>
                    <small>åŠ¹ç‡ãƒ»å“è³ªã‚’å„ªå…ˆã—ãŸã„</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="budget" value="biz" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>æ¥­å‹™åˆ©ç”¨ï¼ˆæ³•äººï¼‰</b>
                    <small>å®‰å…¨æ€§ãƒ»é‹ç”¨ã‚’é‡è¦–</small>
                  </span>
                </label>
              </div>
            </div>

            <!-- Q5 -->
            <div class="q" data-q="priority">
              <div class="label">
                <strong>Q5. ä½•ã‚’å„ªå…ˆã™ã‚‹ï¼Ÿ</strong>
                <span>å¿…é ˆ</span>
              </div>
              <div class="options" role="radiogroup" aria-label="å„ªå…ˆåº¦">
                <label class="opt" tabindex="0">
                  <input type="radio" name="priority" value="quality" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>å“è³ªï¼ˆç²¾åº¦ãƒ»è¡¨ç¾åŠ›ï¼‰</b>
                    <small>å¤šå°‘é…ãã¦ã‚‚OK</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="priority" value="speed" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>é€Ÿã•ï¼ˆã‚µã‚¯ã‚µã‚¯ï¼‰</b>
                    <small>ãƒ†ãƒ³ãƒé‡è¦–</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="priority" value="cost" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>ã‚³ã‚¹ãƒ‘</b>
                    <small>ç„¡æ–™/å®‰ã„ã®ãŒæœ€å„ªå…ˆ</small>
                  </span>
                </label>
                <label class="opt" tabindex="0">
                  <input type="radio" name="priority" value="privacy" />
                  <span class="mark" aria-hidden="true"></span>
                  <span class="txt">
                    <b>å®‰å…¨æ€§ï¼ˆæ©Ÿå¯†ãƒ»å€‹äººæƒ…å ±ï¼‰</b>
                    <small>ç¤¾å†…ãƒ»é¡§å®¢æƒ…å ±ã‚’æ‰±ã†</small>
                  </span>
                </label>
              </div>
            </div>

            <div class="controls">
              <div class="left">
                <button class="btn" id="btnSave" type="button">å›ç­”ã‚’ä¿å­˜</button>
                <button class="btn" id="btnRestore" type="button">ä¿å­˜ã‚’å¾©å…ƒ</button>
              </div>
              <div class="right">
                <span class="hint" id="validationHint">ã™ã¹ã¦å›ç­”ã™ã‚‹ã¨ãŠã™ã™ã‚ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</span>
                <button class="btn good" id="btnDiagnose" type="button">ãŠã™ã™ã‚ã‚’è¦‹ã‚‹</button>
              </div>
            </div>

            <div class="footer">
              <span>ğŸ§  åˆ¤å®šã¯ã€Œãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã€ã§è¡Œã„ã¾ã™ï¼ˆå¾Œã§APIé€£æºã‚‚å¯èƒ½ï¼‰ã€‚</span>
              <span class="muted">ver 1.0</span>
            </div>
          </form>
        </div>
      </section>

      <!-- RIGHT: Result -->
      <aside class="card" aria-label="è¨ºæ–­çµæœ">
        <div class="hd">
          <div style="display:grid; gap:6px">
            <h2>çµæœ</h2>
            <div class="row">
              <span class="badge" id="resultBadge"><span class="dot w"></span>æœªè¨ºæ–­</span>
              <span class="badge"><span class="dot g"></span>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹ã¤ã</span>
            </div>
          </div>
          <div class="row">
            <button class="btn" id="btnCopyLink" type="button" title="å›ç­”ã‚’URLã«ã—ã¦å…±æœ‰">å…±æœ‰ãƒªãƒ³ã‚¯</button>
            <button class="btn" id="btnCopySummary" type="button" title="çµæœã‚’ã‚³ãƒ”ãƒ¼">çµæœã‚³ãƒ”ãƒ¼</button>
          </div>
        </div>

        <div class="bd">
          <div id="emptyState" class="muted" style="display:grid; gap:10px">
            <div class="badge"><span class="dot"></span>ã¾ãšã¯å·¦ã®5å•ã«å›ç­”</div>
            <div class="small">
              ä¾‹ï¼‰ã€Œæ–‡ç« ã‚’æ›¸ããŸã„ â†’ æ—¥æœ¬èªå¿…é ˆ â†’ å“è³ªé‡è¦–ã€ãªã©ã€ã‚ãªãŸã®æ¡ä»¶ã§ãŠã™ã™ã‚ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚
            </div>
            <div class="divider"></div>
            <details>
              <summary>
                ã“ã®è¨ºæ–­ãŒã§ãã‚‹ã“ã¨
                <span class="muted">â–¼</span>
              </summary>
              <div class="detailsBody small">
                <ul style="margin:0; padding-left:18px; display:grid; gap:6px">
                  <li>ç”¨é€”ã«åˆã†AIã‚«ãƒ†ã‚´ãƒªã‚’ææ¡ˆï¼ˆæ–‡ç« /ç”»åƒ/å‹•ç”»/é–‹ç™ºï¼‰</li>
                  <li>ãŠã™ã™ã‚ã®ç†ç”±ãƒ»æ³¨æ„ç‚¹ãƒ»æœ€åˆã®ä¸€æ­©</li>
                  <li>ãã®ã¾ã¾ã‚³ãƒ”ãƒšã§ãã‚‹ã€Œãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹ã€</li>
                </ul>
              </div>
            </details>
          </div>

          <div id="resultArea" style="display:none">
            <div class="results" id="results"></div>

            <details style="margin-top:12px">
              <summary>
                åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆé€æ˜æ€§ï¼‰
                <span class="muted">â–¼</span>
              </summary>
              <div class="detailsBody small">
                <div class="muted" style="margin-bottom:8px">
                  ã“ã“ã¯ã€Œãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã€ã®ãŸã‚ã€èª¬æ˜å¯èƒ½ã§ã™ã€‚å¿…è¦ãªã‚‰æ¡ä»¶ã‚’å¢—ã‚„ã—ã¦ç²¾åº¦ã‚’ä¸Šã’ã‚‰ã‚Œã¾ã™ã€‚
                </div>
                <div class="mono" id="logicDump"></div>
              </div>
            </details>

            <details style="margin-top:12px">
              <summary>
                APIé€£æºã®æ‹¡å¼µï¼ˆä»»æ„ï¼‰
                <span class="muted">â–¼</span>
              </summary>
              <div class="detailsBody small">
                <p style="margin:0 0 8px">
                  ã“ã®index.htmlã¯APIç„¡ã—ã§å‹•ãã¾ã™ã€‚<br/>
                  ã‚‚ã—ã€ŒLLMã«è‡ªç„¶æ–‡ã§åˆ¤å®šã•ã›ãŸã„ã€ãªã‚‰ã€Cloudflare Workers / Firebase Functions ãªã©ã§
                  <span class="muted">ã‚µãƒ¼ãƒãƒ¼å´</span>ã«APIã‚­ãƒ¼ã‚’ç½®ãã®ãŒãŠã™ã™ã‚ã§ã™ï¼ˆã‚­ãƒ¼ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«ç½®ã‹ãªã„ï¼‰ã€‚
                </p>
                <div class="mono">ä¾‹ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼å›ç­”JSON â†’ ã‚µãƒ¼ãƒãƒ¼ â†’ LLM â†’ æ¨è–¦æ–‡ + è£œè¶³</div>
              </div>
            </details>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // =========================
    // Data (å€™è£œAIã®"å‹"ã¨ã—ã¦æ‰±ã†)
    // =========================
    const CANDIDATES = [
      {
        id: "chatgpt",
        name: "ChatGPTï¼ˆæ±ç”¨LLMï¼‰",
        tags: ["æ–‡ç« ", "ä¼ç”»", "è¦ç´„", "ç›¸è«‡", "ã‚³ãƒ¼ãƒ‰"],
        bestFor: ["æ–‡ç« ä½œæˆ", "è¦ç´„ãƒ»ç¿»è¨³", "ã‚¢ã‚¤ãƒ‡ã‚¢å‡ºã—", "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ç›¸è«‡"],
        notes: [
          "ä¸‡èƒ½å‹ã€‚è¿·ã£ãŸã‚‰ã¾ãšã“ã‚Œã€‚",
          "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒçŸ­ãã¦ã‚‚ãã“ãã“è‰¯ã„çµæœãŒå‡ºã‚„ã™ã„ã€‚"
        ],
        promptTemplates: {
          writing: `ã‚ãªãŸã¯å„ªç§€ãªç·¨é›†è€…ã§ã™ã€‚æ¬¡ã®æ¡ä»¶ã§æ–‡ç« ã‚’ä½œã£ã¦ãã ã•ã„ã€‚\n- ç›®çš„ï¼š{ç›®çš„}\n- èª­è€…ï¼š{èª­è€…}\n- ãƒˆãƒ¼ãƒ³ï¼š{ä¸å¯§/ãƒ•ãƒ©ãƒ³ã‚¯}\n- æ–‡å­—æ•°ï¼š{ç›®å®‰}\n- å¿…ãšå…¥ã‚Œã‚‹è¦ç´ ï¼š{ç®‡æ¡æ›¸ã}\n\nç´ æ:\n{æœ¬æ–‡/ãƒ¡ãƒ¢}`,
          coding: `ã‚ãªãŸã¯çµŒé¨“è±Šå¯Œãªã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™ã€‚æ¬¡ã‚’æº€ãŸã™å®Ÿè£…æ¡ˆã‚’ãã ã•ã„ã€‚\n- ç›®çš„ï¼š{ç›®çš„}\n- ä½¿ã†æŠ€è¡“ï¼š{ä¾‹: HTML/CSS/JS}\n- åˆ¶ç´„ï¼š{ç„¡æ–™/ç°¡å˜/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£}\n- å‡ºåŠ›ï¼šæ‰‹é † + ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ + æ³¨æ„ç‚¹\n\nç¾çŠ¶:\n{çŠ¶æ³/ã‚¨ãƒ©ãƒ¼/ã‚³ãƒ¼ãƒ‰}`
        }
      },
      {
        id: "claude",
        name: "Claudeï¼ˆé•·æ–‡ãƒ»æ–‡ç« å¯„ã‚Šï¼‰",
        tags: ["é•·æ–‡", "è¦ç´„", "æ§‹æˆ", "æ¨æ•²"],
        bestFor: ["é•·æ–‡æ•´ç†", "æ§‹æˆãƒ»æ¨æ•²", "ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ"],
        notes: [
          "é•·æ–‡ã®æ‰±ã„ãŒå¾—æ„ãªå‚¾å‘ã€‚",
          "æ–‡ç« ã®èª­ã¿ã‚„ã™ã•ãƒ»æ§‹æˆã®æ•´ãˆæ–¹ãŒå¼·ã„ã€‚"
        ],
        promptTemplates: {
          writing: `æ¬¡ã®æ–‡ç« ã‚’ã€Œèª­ã¿ã‚„ã™ãã€èª¤è§£ãŒãªã„ã€å½¢ã«æ•´ãˆã¦ãã ã•ã„ã€‚\n- ç›®çš„ï¼š{ä¾‹: ç¤¾å†…ãƒ¡ãƒ¼ãƒ«/å ±å‘Š}\n- ãƒˆãƒ¼ãƒ³ï¼š{ä¸å¯§/ç°¡æ½”/æŸ”ã‚‰ã‹ã}\n- è¿½åŠ ã—ã¦ã»ã—ã„è¦³ç‚¹ï¼š{æŠœã‘æ¼ã‚Œãƒã‚§ãƒƒã‚¯/å‰ææ•´ç†}\n\nåŸæ–‡:\n{æœ¬æ–‡}`
        }
      },
      {
        id: "gemini",
        name: "Geminiï¼ˆæ¤œç´¢ãƒ»çµ±åˆå¯„ã‚Šï¼‰",
        tags: ["èª¿ã¹ç‰©", "è¦ç‚¹æ•´ç†", "ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«"],
        bestFor: ["èª¿æŸ»â†’è¦ç´„", "æ¯”è¼ƒè¡¨", "å­¦ç¿’ç”¨é€”"],
        notes: [
          "èª¿æŸ»ãƒ»æ•´ç†ã®ä½“é¨“ãŒå¼·ã„ã“ã¨ãŒå¤šã„ã€‚",
          "ç”¨é€”ã«ã‚ˆã£ã¦ã¯â€œæƒ…å ±æ•´ç†å½¹â€ã¨ã—ã¦ä¾¿åˆ©ã€‚"
        ],
        promptTemplates: {
          writing: `æ¬¡ã®ãƒ†ãƒ¼ãƒã«ã¤ã„ã¦ã€åˆå¿ƒè€…å‘ã‘ã«ã€Œçµè«–â†’ç†ç”±â†’å…·ä½“ä¾‹ã€ã®é †ã§èª¬æ˜ã—ã¦ãã ã•ã„ã€‚\n- ãƒ†ãƒ¼ãƒï¼š{ãƒ†ãƒ¼ãƒ}\n- æ–‡å­—æ•°ï¼š{ç›®å®‰}\n- æœ€å¾Œã«ï¼šè¦ç‚¹3ã¤ã®ç®‡æ¡æ›¸ã\n\næ¡ä»¶:\n{æ¡ä»¶}`
        }
      },
      {
        id: "dalle",
        name: "DALLÂ·Eï¼ˆç”»åƒç”Ÿæˆï¼‰",
        tags: ["ç”»åƒ", "ã‚¢ã‚¤ã‚³ãƒ³", "ã‚µãƒ ãƒ", "ãƒ‡ã‚¶ã‚¤ãƒ³"],
        bestFor: ["ã‚µãƒ ãƒæ¡ˆ", "ã‚¢ã‚¤ã‚³ãƒ³æ¡ˆ", "ã‚·ãƒ³ãƒ—ãƒ«ãªç´ æç”Ÿæˆ"],
        notes: [
          "çŸ­ã„æŒ‡ç¤ºã§ã‚‚ç ´ç¶»ã—ã«ãã„ã‚¿ã‚¤ãƒ—ã€‚",
          "ãƒ‡ã‚¶ã‚¤ãƒ³æ¡ˆã®å©ãå°ã«å‘ãã€‚"
        ],
        promptTemplates: {
          image: `æ—¥æœ¬ã®SNSå‘ã‘ã€‚æ¬¡ã®æ¡ä»¶ã§ç”»åƒã‚’ç”Ÿæˆã™ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œã£ã¦ã€‚\n- ç”¨é€”ï¼š{ä¾‹: TikTokã‚µãƒ ãƒ}\n- ç”»è§’ï¼š{ä¾‹: æ¨ªé•·/ç¸¦é•·}\n- ãƒ†ã‚¤ã‚¹ãƒˆï¼š{ä¾‹: ã‹ã‚ã„ã„/ã‚·ãƒ³ãƒ—ãƒ«/ãƒŸãƒ¼ãƒ }\n- æ–‡å­—å…¥ã‚Œï¼š{ã‚ã‚Š/ãªã—}\n- ä¼ãˆãŸã„ã“ã¨ï¼š{ä¸€ç›®ã§}\n\nå‡ºåŠ›ï¼šç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆè‹±èªï¼‰ + ãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆä»»æ„ï¼‰`
        }
      },
      {
        id: "stablediff",
        name: "Stable Diffusionï¼ˆç”»åƒãƒ»è‡ªç”±åº¦é«˜ã‚ï¼‰",
        tags: ["ç”»åƒ", "èª¿æ•´", "ãƒ­ãƒ¼ã‚«ãƒ«", "è‡ªç”±åº¦"],
        bestFor: ["ã“ã ã‚ã‚Šèª¿æ•´", "LoRA/ã‚¹ã‚¿ã‚¤ãƒ«", "å¤§é‡ç”Ÿæˆ"],
        notes: [
          "è¨­å®šãŒå¤šã„åˆ†ã€ãƒãƒã‚‹ã¨å¼·ã„ã€‚",
          "ä¸­ç´šä»¥ä¸Šã‚„â€œçµµä½œã‚Šâ€ã«ã“ã ã‚ã‚‹äººå‘ã‘ã€‚"
        ],
        promptTemplates: {
          image: `æ¬¡ã®æ¡ä»¶ã§Stable Diffusionç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œæˆã€‚\n- è¢«å†™ä½“ï¼š{è¢«å†™ä½“}\n- ã‚¹ã‚¿ã‚¤ãƒ«ï¼š{ã‚¢ãƒ‹ãƒ¡/å†™çœŸ/ã‚¤ãƒ©ã‚¹ãƒˆ}\n- é›°å›²æ°—ï¼š{ã‹ã‚ã„ã„/æš—ã„/ãƒãƒƒãƒ—}\n- ç”»è§’ï¼š{ç¸¦/æ¨ª/æ­£æ–¹å½¢}\n\nå‡ºåŠ›ï¼šPositive / Negative / æ¨å¥¨è¨­å®šï¼ˆsteps, cfg, samplerï¼‰`
        }
      },
      {
        id: "runway",
        name: "Runway / Pikaï¼ˆå‹•ç”»ç”Ÿæˆç³»ï¼‰",
        tags: ["å‹•ç”»", "ã‚·ãƒ§ãƒ¼ãƒˆ", "æ¼”å‡º"],
        bestFor: ["çŸ­å°ºå‹•ç”»", "ç°¡å˜ãªæ˜ åƒåŒ–", "SNSå‘ã‘æ¼”å‡º"],
        notes: [
          "UIãŒã‚ã‹ã‚Šã‚„ã™ã„ã‚‚ã®ãŒå¤šã„ã€‚",
          "çŸ­å°ºã§æ˜ ãˆã‚‹å‹•ç”»ã«å‘ãã€‚"
        ],
        promptTemplates: {
          video: `15ç§’ã®ç¸¦å‹ã‚·ãƒ§ãƒ¼ãƒˆå‹•ç”»ã‚’ä½œã‚‹ãŸã‚ã®è‹±èªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œã£ã¦ã€‚\n- ä¸»äººå…¬ï¼š{ã‚­ãƒ£ãƒ©}\n- ä¸–ç•Œè¦³ï¼š{é›°å›²æ°—}\n- æ§‹æˆï¼šåºç›¤â†’ä¸­ç›¤â†’ã‚ªãƒï¼ˆå„5ç§’ï¼‰\n- ã‚«ãƒ¡ãƒ©ï¼šå®‰å®š/ã‚ºãƒ¼ãƒ /ãƒ‘ãƒ³ãªã©\n- ãƒ†ãƒ­ãƒƒãƒ—æ¡ˆï¼šçŸ­ã„æ—¥æœ¬èª\n\nå‡ºåŠ›ï¼šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ + ã‚·ãƒ¼ãƒ³åˆ†å‰² + ãƒ†ãƒ­ãƒƒãƒ—`
        }
      },
      {
        id: "ltx",
        name: "LTXç³»ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«å‹•ç”»ãƒ»ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼‰",
        tags: ["å‹•ç”»", "ãƒ­ãƒ¼ã‚«ãƒ«", "é«˜è‡ªç”±åº¦", "æŠ€è¡“å¯„ã‚Š"],
        bestFor: ["ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆ", "å®Ÿé¨“", "ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ§‹ç¯‰"],
        notes: [
          "ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚„VRAMãªã©ç’°å¢ƒè¦ä»¶ãŒã‚ã‚‹ã€‚",
          "ComfyUIç­‰ã¨çµ„ã‚€ã¨æ‹¡å¼µæ€§ãŒé«˜ã„ã€‚"
        ],
        promptTemplates: {
          video: `LTXç”¨ã«ã€æ¬¡ã‚’æº€ãŸã™è‹±èªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ›¸ã„ã¦ã€‚\n- ã‚·ãƒ§ãƒƒãƒˆæ•°ï¼š{ä¾‹: 3}\n- ç”»è§’ï¼š{ç¸¦/æ¨ª}\n- ã‚­ãƒ£ãƒ©ï¼š{ç‰¹å¾´}\n- å‹•ãï¼š{è‡ªç„¶/ã‚†ã£ãã‚Š}\n- èƒŒæ™¯ï¼š{å ´æ‰€}\n- NGï¼šç ´ç¶»ã—ã‚„ã™ã„è¦ç´ ã®å›é¿\n\nå‡ºåŠ›ï¼šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ + ãƒã‚¬ï¼ˆä»»æ„ï¼‰ + æ¨å¥¨ãƒ•ãƒ¬ãƒ¼ãƒ /è§£åƒåº¦ã®ç›®å®‰`
        }
      },
      {
        id: "copilot",
        name: "GitHub Copilotï¼ˆé–‹ç™ºè£œåŠ©ï¼‰",
        tags: ["ã‚³ãƒ¼ãƒ‰", "è£œå®Œ", "IDE"],
        bestFor: ["å®Ÿè£…ã‚¹ãƒ”ãƒ¼ãƒ‰UP", "IDEå†…è£œå®Œ", "åå¾©ä½œæ¥­"],
        notes: [
          "ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã®è£œå®ŒãŒå¼·ã¿ã€‚",
          "è¨­è¨ˆç›¸è«‡ã¯åˆ¥ã®LLMã¨ä½µç”¨ãŒåŠ¹ãã€‚"
        ],
        promptTemplates: {
          coding: `ã“ã®é–¢æ•°ï¼ˆã¾ãŸã¯ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®æ„å›³ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§èª¬æ˜ã—ã€æ”¹å–„ç‚¹ã‚’ææ¡ˆã—ã¦ã€‚\n- ç›®çš„ï¼š{ç›®çš„}\n- åˆ¶ç´„ï¼š{åˆ¶ç´„}\n\nã‚³ãƒ¼ãƒ‰:\n{ã‚³ãƒ¼ãƒ‰}`
        }
      }
    ];

    // =========================
    // Simple rule engine
    // =========================
    function scoreCandidates(answers){
      const scores = new Map(CANDIDATES.map(c => [c.id, {score:0, reasons:[], cautions:[]}]));

      const add = (id, n, reason) => {
        const it = scores.get(id);
        it.score += n;
        if(reason) it.reasons.push(reason);
      };
      const caution = (id, text) => {
        const it = scores.get(id);
        it.cautions.push(text);
      };

      const { goal, level, jp, budget, priority } = answers;

      // Goal weighting
      if(goal === "writing"){
        add("chatgpt", 28, "æ–‡ç« ç³»ã®ä¸‡èƒ½å‹ã¨ã—ã¦å®‰å®š");
        add("claude", 26, "é•·æ–‡ã®æ•´ç†ãƒ»æ¨æ•²ãŒå¾—æ„");
        add("gemini", 18, "èª¿æŸ»â†’è¦ç‚¹æ•´ç†ã«å‘ã");
      }
      if(goal === "image"){
        add("dalle", 28, "çŸ­ã„æŒ‡ç¤ºã§ã‚‚ç”»åƒãŒä½œã‚Šã‚„ã™ã„");
        add("stablediff", 24, "ã“ã ã‚ã‚Šèª¿æ•´ã‚„å¤§é‡ç”Ÿæˆã«å¼·ã„");
        add("chatgpt", 10, "ç”»åƒãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆã®ç›¸æ£’ã¨ã—ã¦ä¾¿åˆ©");
      }
      if(goal === "video"){
        add("runway", 26, "æ‰‹è»½ã«SNSå‘ã‘çŸ­å°ºã‚’ä½œã‚Šã‚„ã™ã„");
        add("ltx", 22, "ãƒ­ãƒ¼ã‚«ãƒ«/ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ§‹ç¯‰ã§è‡ªç”±åº¦ãŒé«˜ã„");
        add("chatgpt", 12, "æ§‹æˆãƒ»ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆã«å¼·ã„");
      }
      if(goal === "coding"){
        add("chatgpt", 26, "è¨­è¨ˆç›¸è«‡ãƒ»ãƒ‡ãƒãƒƒã‚°ã®è¨€èªåŒ–ãŒå¾—æ„");
        add("copilot", 22, "IDEè£œå®Œã§å®Ÿè£…ã‚¹ãƒ”ãƒ¼ãƒ‰ãŒä¸ŠãŒã‚‹");
        add("gemini", 14, "è¦ç‚¹æ•´ç†ãƒ»æ¯”è¼ƒè¡¨ãŒå¾—æ„");
      }

      // Level
      if(level === "beginner"){
        add("chatgpt", 12, "åˆå¿ƒè€…ã§ã‚‚æ‰±ã„ã‚„ã™ã„");
        add("dalle", 10, "æ“ä½œãŒã‚·ãƒ³ãƒ—ãƒ«å¯„ã‚Šã§å§‹ã‚ã‚„ã™ã„");
        add("runway", 10, "UIã§ç›´æ„Ÿçš„ã«ä½œã‚Šã‚„ã™ã„");
        caution("stablediff", "Stable Diffusionã¯è¨­å®šé …ç›®ãŒå¤šãã€æœ€åˆã¯è¿·ã„ã‚„ã™ã„");
        caution("ltx", "LTXç³»ã¯ç’°å¢ƒï¼ˆVRAM/è¨­å®šï¼‰ã§è©°ã¾ã‚Šã‚„ã™ã„ã“ã¨ãŒã‚ã‚‹");
      }
      if(level === "intermediate"){
        add("stablediff", 6, "èª¿æ•´ã™ã‚‹ã»ã©ä¼¸ã³ã‚‹ã‚¿ã‚¤ãƒ—");
        add("ltx", 6, "ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ä¼¸ã³ã‚‹");
        add("copilot", 6, "é–‹ç™ºä½“é¨“ãŒè‰¯ããªã‚‹");
      }
      if(level === "advanced"){
        add("stablediff", 8, "é«˜åº¦ãªèª¿æ•´ãƒ»é‹ç”¨ãŒå¯èƒ½");
        add("ltx", 8, "ãƒ­ãƒ¼ã‚«ãƒ«æœ€é©åŒ–ãŒæ´»ãã‚‹");
        add("copilot", 8, "IDE/ãƒªãƒã‚¸ãƒˆãƒªé€£æºã‚’æ´»ã‹ã›ã‚‹");
      }

      // Japanese priority
      if(jp === "must"){
        add("chatgpt", 10, "æ—¥æœ¬èªã®è‡ªç„¶ã•ã‚’å„ªå…ˆã—ã‚„ã™ã„");
        add("claude", 8, "æ–‡ç« ã®æ•´ãˆãŒå¾—æ„");
      } else if(jp === "nice"){
        add("chatgpt", 6, "æ—¥æœ¬èªã®å®‰å®šæ„Ÿ");
      }

      // Budget
      if(budget === "free"){
        add("stablediff", 8, "ãƒ­ãƒ¼ã‚«ãƒ«é‹ç”¨ãªã‚‰ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã‚„ã™ã„");
        add("ltx", 8, "ãƒ­ãƒ¼ã‚«ãƒ«é‹ç”¨ãªã‚‰ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã‚„ã™ã„");
        add("gemini", 4, "ç„¡æ–™æ ãŒã‚ã‚‹å ´åˆãŒå¤šã„");
        caution("runway", "å‹•ç”»ç³»ã¯ç„¡æ–™æ ãŒå°‘ãªã‚/åˆ¶é™ãŒå‡ºã‚„ã™ã„");
      }
      if(budget === "biz"){
        add("chatgpt", 6, "æ¥­å‹™åˆ©ç”¨ãƒ—ãƒ©ãƒ³/é‹ç”¨ãŒæ•´ã£ã¦ã„ã‚‹å ´åˆãŒã‚ã‚‹");
        add("gemini", 6, "æ¥­å‹™å‘ã‘é‹ç”¨ã‚’æƒ³å®šã—ã‚„ã™ã„å ´åˆãŒã‚ã‚‹");
        caution("stablediff", "ç¤¾å†…é‹ç”¨ãªã‚‰â€œç´ æã®æ¨©åˆ©/ãƒ¢ãƒ‡ãƒ«ç®¡ç†â€ã®ãƒ«ãƒ¼ãƒ«ä½œã‚ŠãŒå¿…è¦");
      }

      // Priority
      if(priority === "quality"){
        add("claude", 8, "æ–‡ç« å“è³ªãƒ»æ§‹æˆã«å¼·ã„");
        add("stablediff", 8, "ç”»åƒã®ã“ã ã‚ã‚Šå“è³ªã‚’è©°ã‚ã‚‰ã‚Œã‚‹");
        add("ltx", 6, "å‹•ç”»ã®è‡ªç”±åº¦ã§è©°ã‚ã‚‰ã‚Œã‚‹");
        add("chatgpt", 6, "ç·åˆå“è³ªãŒå®‰å®š");
      }
      if(priority === "speed"){
        add("copilot", 10, "å®Ÿè£…é€Ÿåº¦ãŒä¸ŠãŒã‚‹");
        add("runway", 6, "çŸ­å°ºã‚’ç´ æ—©ãä½œã‚Šã‚„ã™ã„");
        add("chatgpt", 6, "ã‚„ã‚Šå–ã‚ŠãŒé€Ÿã„");
      }
      if(priority === "cost"){
        add("stablediff", 10, "ãƒ­ãƒ¼ã‚«ãƒ«ã§ç¹°ã‚Šè¿”ã—ä½¿ãˆã‚‹");
        add("ltx", 8, "ãƒ­ãƒ¼ã‚«ãƒ«é‹ç”¨ã§ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã‚‰ã‚Œã‚‹");
        add("gemini", 6, "ç„¡æ–™æ å‰æã§ä½¿ã„ã‚„ã™ã„å ´åˆãŒã‚ã‚‹");
      }
      if(priority === "privacy"){
        add("stablediff", 8, "ãƒ­ãƒ¼ã‚«ãƒ«ãªã‚‰æ©Ÿå¯†ã‚’å¤–ã«å‡ºã—ã«ãã„");
        add("ltx", 8, "ãƒ­ãƒ¼ã‚«ãƒ«ãªã‚‰æ©Ÿå¯†ã‚’å¤–ã«å‡ºã—ã«ãã„");
        caution("chatgpt", "æ©Ÿå¯†/å€‹äººæƒ…å ±ã¯ç¤¾å†…ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦å…¥åŠ›ã‚’é¿ã‘ã‚‹ï¼ˆãƒã‚¹ã‚­ãƒ³ã‚°æ¨å¥¨ï¼‰");
        caution("claude", "æ©Ÿå¯†/å€‹äººæƒ…å ±ã¯ç¤¾å†…ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦å…¥åŠ›ã‚’é¿ã‘ã‚‹ï¼ˆãƒã‚¹ã‚­ãƒ³ã‚°æ¨å¥¨ï¼‰");
        caution("gemini", "æ©Ÿå¯†/å€‹äººæƒ…å ±ã¯ç¤¾å†…ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦å…¥åŠ›ã‚’é¿ã‘ã‚‹ï¼ˆãƒã‚¹ã‚­ãƒ³ã‚°æ¨å¥¨ï¼‰");
      }

      // Slight balancing: if goal isn't image, reduce image candidates a bit, etc.
      if(goal !== "image"){
        scores.get("dalle").score -= 6;
        scores.get("stablediff").score -= 4;
      }
      if(goal !== "video"){
        scores.get("runway").score -= 6;
        scores.get("ltx").score -= 4;
      }
      if(goal !== "coding"){
        scores.get("copilot").score -= 4;
      }

      // clamp
      for(const [id, it] of scores){
        it.score = Math.max(0, it.score);
      }

      // Return sorted with merged data
      const list = CANDIDATES.map(c => ({
        ...c,
        score: scores.get(c.id).score,
        reasons: uniq(scores.get(c.id).reasons).slice(0, 5),
        cautions: uniq(scores.get(c.id).cautions).slice(0, 4)
      }))
      .sort((a,b) => b.score - a.score);

      return list;
    }

    function uniq(arr){
      return Array.from(new Set(arr.filter(Boolean)));
    }

    // =========================
    // UI helpers
    // =========================
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    const quiz = $("#quiz");
    const progBar = $("#progBar");
    const progText = $("#progText");
    const stepBadge = $("#stepBadge");
    const validationHint = $("#validationHint");

    const emptyState = $("#emptyState");
    const resultArea = $("#resultArea");
    const resultsEl = $("#results");
    const resultBadge = $("#resultBadge");
    const logicDump = $("#logicDump");

    const toast = $("#toast");

    const REQUIRED = ["goal","level","jp","budget","priority"];

    function getAnswers(){
      const data = {};
      for(const k of REQUIRED){
        const el = quiz.querySelector(`input[name="${k}"]:checked`);
        data[k] = el ? el.value : "";
      }
      return data;
    }

    function countAnswered(ans){
      return REQUIRED.reduce((n,k)=> n + (ans[k] ? 1 : 0), 0);
    }

    function isComplete(ans){
      return REQUIRED.every(k => !!ans[k]);
    }

    function updateProgress(){
      const ans = getAnswers();
      const n = countAnswered(ans);
      progBar.style.width = `${(n/REQUIRED.length)*100}%`;
      progText.textContent = `${n} / ${REQUIRED.length}`;

      if(n === 0){
        stepBadge.innerHTML = `<span class="dot"></span>æœªå›ç­”`;
      }else if(n < REQUIRED.length){
        stepBadge.innerHTML = `<span class="dot w"></span>å›ç­”ä¸­`;
      }else{
        stepBadge.innerHTML = `<span class="dot g"></span>æº–å‚™OK`;
      }

      validationHint.textContent = isComplete(ans)
        ? "æº–å‚™OKï¼ã€ŒãŠã™ã™ã‚ã‚’è¦‹ã‚‹ã€ã‚’æŠ¼ã›ã¾ã™ã€‚"
        : "ã™ã¹ã¦å›ç­”ã™ã‚‹ã¨ãŠã™ã™ã‚ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚";

      // update selected style
      $$(".q").forEach(q=>{
        const name = q.getAttribute("data-q");
        const checked = quiz.querySelector(`input[name="${name}"]:checked`);
        $$(".opt", q).forEach(opt=>{
          const input = $("input", opt);
          opt.classList.toggle("sel", checked && input.value === checked.value);
        });
      });

      // persist minimal state for reload
      localStorage.setItem("ai_diagnosis_autosave", JSON.stringify(ans));
    }

    function showToast(msg){
      toast.textContent = msg;
      toast.style.display = "block";
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()=> toast.style.display = "none", 1800);
    }

    // Keyboard accessibility: allow Enter/Space on label.opt
    function wireOptionKeys(){
      $$(".opt").forEach(opt=>{
        opt.addEventListener("keydown", (e)=>{
          if(e.key === "Enter" || e.key === " "){
            e.preventDefault();
            const input = $("input", opt);
            input.checked = true;
            input.dispatchEvent(new Event("change", {bubbles:true}));
          }
        });
      });
    }

    // =========================
    // Render results
    // =========================
    function renderResults(){
      const ans = getAnswers();
      if(!isComplete(ans)){
        showToast("5å•ã™ã¹ã¦å›ç­”ã—ã¦ãã ã•ã„");
        return;
      }

      const ranked = scoreCandidates(ans);
      const top = ranked.slice(0, 3);

      // UI switch
      emptyState.style.display = "none";
      resultArea.style.display = "block";
      resultBadge.innerHTML = `<span class="dot g"></span>è¨ºæ–­æ¸ˆã¿`;

      resultsEl.innerHTML = "";
      top.forEach((c, idx)=>{
        const why = c.reasons.length ? c.reasons.map(x => `â€¢ ${escapeHtml(x)}`).join("<br>") : "â€¢ æ¡ä»¶ã«åˆè‡´";
        const caut = c.cautions.length ? c.cautions.map(x => `â€¢ ${escapeHtml(x)}`).join("<br>") : "â€¢ ç‰¹ã«ãªã—";

        const prompt = pickPrompt(c, ans);
        const promptBlock = prompt
          ? `<div class="kv">
               <b>æœ€åˆã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹ï¼ˆã‚³ãƒ”ãƒšOKï¼‰</b>
               <p class="muted">{} ã¯ã‚ãªãŸã®å†…å®¹ã«ç½®ãæ›ãˆã¦ã­ã€‚</p>
               <div class="mono">${escapeHtml(prompt)}</div>
             </div>`
          : "";

        const card = document.createElement("div");
        card.className = "resCard";
        card.innerHTML = `
          <div class="top">
            <div class="name">
              <strong>#${idx+1} ${escapeHtml(c.name)}</strong>
              <div class="chips">
                ${c.tags.slice(0,4).map(t=>`<span class="chip">${escapeHtml(t)}</span>`).join("")}
              </div>
            </div>
            <div class="score">
              <div class="n">${Math.round(c.score)}</div>
              <div class="sub">ãƒãƒƒãƒåº¦</div>
            </div>
          </div>
          <div class="mid">
            <div class="kvs">
              <div class="kv">
                <b>ãŠã™ã™ã‚ç†ç”±</b>
                <p>${why}</p>
              </div>
              <div class="kv">
                <b>å‘ã„ã¦ã„ã‚‹ä½¿ã„æ–¹</b>
                <p class="muted">${escapeHtml(c.bestFor.join(" / "))}</p>
              </div>
              <div class="kv">
                <b>æ³¨æ„ç‚¹</b>
                <p>${caut}</p>
              </div>
              ${promptBlock}
            </div>
          </div>
        `;
        resultsEl.appendChild(card);
      });

      // Logic dump
      logicDump.textContent = JSON.stringify({
        answers: ans,
        top3: top.map(x => ({ id:x.id, name:x.name, score:x.score, reasons:x.reasons, cautions:x.cautions }))
      }, null, 2);

      // Save last result for copy
      localStorage.setItem("ai_diagnosis_last_result", JSON.stringify({answers:ans, top}));
      showToast("ãŠã™ã™ã‚ã‚’è¡¨ç¤ºã—ã¾ã—ãŸ");
      // scroll into view on mobile
      resultArea.scrollIntoView({behavior:"smooth", block:"start"});
    }

    function pickPrompt(candidate, ans){
      const g = ans.goal;
      const t = candidate.promptTemplates || {};
      if(g === "writing") return t.writing || t.coding || "";
      if(g === "coding") return t.coding || t.writing || "";
      if(g === "image") return t.image || "";
      if(g === "video") return t.video || "";
      return "";
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // =========================
    // Persistence & Share link
    // =========================
    function saveAnswers(){
      const ans = getAnswers();
      localStorage.setItem("ai_diagnosis_saved", JSON.stringify(ans));
      showToast("å›ç­”ã‚’ä¿å­˜ã—ã¾ã—ãŸ");
    }

    function restoreAnswers(){
      const raw = localStorage.getItem("ai_diagnosis_saved");
      if(!raw){ showToast("ä¿å­˜ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“"); return; }
      applyAnswers(JSON.parse(raw));
      showToast("ä¿å­˜ã‚’å¾©å…ƒã—ã¾ã—ãŸ");
    }

    function applyAnswers(ans){
      for(const k of REQUIRED){
        if(!ans[k]) continue;
        const el = quiz.querySelector(`input[name="${k}"][value="${ans[k]}"]`);
        if(el) el.checked = true;
      }
      updateProgress();
    }

    // URL share (answers in query string, short-ish)
    function encodeAnswersToUrl(ans){
      const params = new URLSearchParams();
      for(const k of REQUIRED){
        if(ans[k]) params.set(k, ans[k]);
      }
      const url = new URL(location.href);
      url.hash = "#diagnosis";
      url.search = params.toString();
      return url.toString();
    }

    function loadFromUrl(){
      const params = new URLSearchParams(location.search);
      const ans = {};
      for(const k of REQUIRED){
        const v = params.get(k);
        if(v) ans[k] = v;
      }
      if(Object.keys(ans).length){
        applyAnswers(ans);
        // If complete, auto-render
        if(isComplete(getAnswers())) renderResults();
      }
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        showToast("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
      }catch{
        // fallback
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
        showToast("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
      }
    }

    function copyLink(){
      const ans = getAnswers();
      if(!countAnswered(ans)){ showToast("ã¾ãšå›ç­”ã—ã¦ãã ã•ã„"); return; }
      const url = encodeAnswersToUrl(ans);
      copyText(url);
    }

    function copySummary(){
      const raw = localStorage.getItem("ai_diagnosis_last_result");
      if(!raw){ showToast("ã¾ã çµæœãŒã‚ã‚Šã¾ã›ã‚“"); return; }
      const {answers, top} = JSON.parse(raw);
      const lines = [];
      lines.push("AIè¨ºæ–­çµæœï¼ˆTop3ï¼‰");
      lines.push("");
      lines.push(`å›ç­”ï¼š${JSON.stringify(answers)}`);
      lines.push("");
      top.forEach((c,i)=>{
        lines.push(`#${i+1} ${c.name}ï¼ˆãƒãƒƒãƒåº¦ ${Math.round(c.score)}ï¼‰`);
        if(c.reasons?.length) lines.push("ç†ç”±ï¼š " + c.reasons.join(" / "));
        if(c.cautions?.length) lines.push("æ³¨æ„ï¼š " + c.cautions.join(" / "));
        lines.push("");
      });
      copyText(lines.join("\n"));
    }

    // =========================
    // Events
    // =========================
    quiz.addEventListener("change", updateProgress);

    $("#btnDiagnose").addEventListener("click", renderResults);
    $("#btnSave").addEventListener("click", saveAnswers);
    $("#btnRestore").addEventListener("click", restoreAnswers);
    $("#btnCopyLink").addEventListener("click", copyLink);
    $("#btnCopySummary").addEventListener("click", copySummary);

    $("#btnReset").addEventListener("click", ()=>{
      quiz.reset();
      updateProgress();
      emptyState.style.display = "grid";
      resultArea.style.display = "none";
      resultBadge.innerHTML = `<span class="dot w"></span>æœªè¨ºæ–­`;
      showToast("ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");
      // clear url params
      const url = new URL(location.href);
      url.search = "";
      history.replaceState({}, "", url.toString());
    });

    $("#btnLoadSample").addEventListener("click", ()=>{
      // ã‚µãƒ³ãƒ—ãƒ«ï¼šæ–‡ç« /åˆå¿ƒè€…/æ—¥æœ¬èªå¿…é ˆ/å®‰ã‚/å“è³ª
      applyAnswers({goal:"writing", level:"beginner", jp:"must", budget:"low", priority:"quality"});
      renderResults();
    });

    // Auto-restore autosave
    (function init(){
      wireOptionKeys();
      const auto = localStorage.getItem("ai_diagnosis_autosave");
      if(auto){
        try{ applyAnswers(JSON.parse(auto)); }catch{}
      }
      updateProgress();
      loadFromUrl();
    })();
  </script>
</body>
</html>ã€€ã€€
