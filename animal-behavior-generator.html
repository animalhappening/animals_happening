<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>å‹•ç‰©è¡Œå‹•ç”Ÿæˆå™¨</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Caveat:wght@700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Fredoka', sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            touch-action: none;
            position: relative;
        }
        
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }
        
        #behavior-display {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
            pointer-events: none;
            width: 90%;
            max-width: 600px;
        }
        
        #animal-name {
            font-size: clamp(32px, 8vw, 64px);
            font-weight: 700;
            margin-bottom: 20px;
            opacity: 0;
            transform: scale(0.5) rotate(-10deg);
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            text-shadow: 4px 4px 0 rgba(0, 0, 0, 0.3);
        }
        
        #animal-name.active {
            opacity: 1;
            transform: scale(1) rotate(0deg);
        }
        
        #behavior-text {
            font-family: 'Caveat', cursive;
            font-size: clamp(20px, 5vw, 36px);
            line-height: 1.6;
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
            border: 3px dashed rgba(255, 255, 255, 0.5);
        }
        
        #behavior-text.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        #main-button {
            position: fixed;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%) scale(1);
            padding: 25px 50px;
            font-family: 'Fredoka', sans-serif;
            font-size: clamp(20px, 5vw, 32px);
            font-weight: 700;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: #fff;
            border: none;
            border-radius: 100px;
            cursor: pointer;
            pointer-events: all;
            z-index: 20;
            box-shadow: 0 10px 40px rgba(245, 87, 108, 0.6);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        #main-button:hover {
            transform: translateX(-50%) scale(1.1);
            box-shadow: 0 15px 50px rgba(245, 87, 108, 0.8);
        }
        
        #main-button:active {
            transform: translateX(-50%) scale(0.95);
        }
        
        #main-button.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translateX(-50%) scale(0.3);
        }
        
        .animal-emoji {
            position: absolute;
            font-size: 60px;
            pointer-events: none;
            z-index: 5;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }
        

    </style>
</head>
<body>
    <div id="canvas-container"></div>
    
    <div id="behavior-display">
        <div id="animal-name"></div>
        <div id="behavior-text"></div>
    </div>
    
    <button id="main-button">è¦³æ¸¬ã™ã‚‹</button>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // çœŸã®ä¹±æ•°ç”Ÿæˆ
        class TrueRandom {
            static seed = performance.now() + Date.now();
            
            static get() {
                this.seed = (this.seed * 9301 + 49297) % 233280;
                return (this.seed / 233280) * Math.random() * performance.now() % 1;
            }
            
            static range(min, max) {
                return min + this.get() * (max - min);
            }
            
            static int(min, max) {
                return Math.floor(this.range(min, max + 1));
            }
            
            static choice(array) {
                return array[this.int(0, array.length - 1)];
            }
            
            static shuffle(array) {
                const result = [...array];
                for (let i = result.length - 1; i > 0; i--) {
                    const j = this.int(0, i);
                    [result[i], result[j]] = [result[j], result[i]];
                }
                return result;
            }
        }
        
        // å‹•ç‰©ã¨è¡Œå‹•ã®è‡ªå‹•ç”Ÿæˆ
        class BehaviorGenerator {
            static animals = [
                'ğŸ¶', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸ¨', 'ğŸ¯', 
                'ğŸ¦', 'ğŸ®', 'ğŸ·', 'ğŸ¸', 'ğŸµ', 'ğŸ”', 'ğŸ§', 'ğŸ¦', 'ğŸ¤', 'ğŸ¦†',
                'ğŸ¦…', 'ğŸ¦‰', 'ğŸ¦‡', 'ğŸº', 'ğŸ—', 'ğŸ´', 'ğŸ¦„', 'ğŸ', 'ğŸ›', 'ğŸ¦‹',
                'ğŸŒ', 'ğŸ', 'ğŸœ', 'ğŸ¦Ÿ', 'ğŸ¦—', 'ğŸ•·', 'ğŸ¦‚', 'ğŸ¢', 'ğŸ', 'ğŸ¦',
                'ğŸ¦–', 'ğŸ¦•', 'ğŸ™', 'ğŸ¦‘', 'ğŸ¦', 'ğŸ¦', 'ğŸ¦€', 'ğŸ¡', 'ğŸ ', 'ğŸŸ',
                'ğŸ¬', 'ğŸ³', 'ğŸ‹', 'ğŸ¦ˆ', 'ğŸŠ', 'ğŸ…', 'ğŸ†', 'ğŸ¦“', 'ğŸ¦', 'ğŸ¦§',
                'ğŸ˜', 'ğŸ¦›', 'ğŸ¦', 'ğŸª', 'ğŸ«', 'ğŸ¦’', 'ğŸ¦˜', 'ğŸ¦¬', 'ğŸƒ', 'ğŸ‚',
                'ğŸ„', 'ğŸ', 'ğŸ–', 'ğŸ', 'ğŸ‘', 'ğŸ¦™', 'ğŸ', 'ğŸ¦Œ', 'ğŸ•', 'ğŸ©',
                'ğŸ¦®', 'ğŸˆ', 'ğŸ¦š', 'ğŸ¦œ', 'ğŸ¦¢', 'ğŸ¦©', 'ğŸ•Š', 'ğŸ‡', 'ğŸ¦', 'ğŸ¦¨',
                'ğŸ¦¡', 'ğŸ¦¦', 'ğŸ¦¥', 'ğŸ', 'ğŸ€', 'ğŸ¿', 'ğŸ¦”'
            ];
            
            static actions = [
                'ãŒçªç„¶', 'ãŒã‚†ã£ãã‚Šã¨', 'ãŒçŒ›çƒˆã«', 'ãŒå„ªé›…ã«', 'ãŒå¿…æ­»ã«',
                'ãŒã“ã£ãã‚Š', 'ãŒå ‚ã€…ã¨', 'ãŒä¸æ€è­°ãã†ã«', 'ãŒå¬‰ã—ãã†ã«', 'ãŒæ‚²ã—ãã†ã«',
                'ãŒæ€’ã‚ŠãªãŒã‚‰', 'ãŒç¬‘ã„ãªãŒã‚‰', 'ãŒéœ‡ãˆãªãŒã‚‰', 'ãŒé£›ã³ãªãŒã‚‰', 'ãŒè»¢ãŒã‚ŠãªãŒã‚‰',
                'ãŒè¸Šã‚ŠãªãŒã‚‰', 'ãŒæ­Œã„ãªãŒã‚‰', 'ãŒå«ã³ãªãŒã‚‰', 'ãŒçœ ã‚ŠãªãŒã‚‰', 'ãŒå¤¢ã®ä¸­ã§'
            ];
            
            static objects = [
                'ç©ºã‚’', 'åœ°é¢ã‚’', 'å£ã‚’', 'æœ¨ã‚’', 'çŸ³ã‚’', 'æ°´ã‚’', 'ç«ã‚’', 'æ°·ã‚’',
                'é›²ã‚’', 'æœˆã‚’', 'æ˜Ÿã‚’', 'è™¹ã‚’', 'é¢¨ã‚’', 'é›·ã‚’', 'å½±ã‚’', 'å…‰ã‚’',
                'éŸ³æ¥½ã‚’', 'è¨€è‘‰ã‚’', 'æ•°å­—ã‚’', 'è‰²ã‚’', 'æ™‚é–“ã‚’', 'è¨˜æ†¶ã‚’', 'å¤¢ã‚’', 'æœªæ¥ã‚’',
                'éå»ã‚’', 'æ¬¡å…ƒã‚’', 'é‡åŠ›ã‚’', 'ç©ºé–“ã‚’', 'é‡å­ã‚’', 'æ³¢å‹•ã‚’'
            ];
            
            static methods = [
                'é£Ÿã¹ãŸ', 'é£²ã‚“ã ', 'æŠ•ã’ãŸ', 'è¹´ã£ãŸ', 'å©ã„ãŸ', 'è¸ã‚“ã ', 'å™›ã‚“ã ', 'èˆã‚ãŸ',
                'å—…ã„ã ', 'è¦‹ã¤ã‚ãŸ', 'æ¡ã£ãŸ', 'æŠ±ãã—ã‚ãŸ', 'æŒ¯ã£ãŸ', 'å›ã—ãŸ', 'ä¼¸ã°ã—ãŸ', 'ç¸®ã‚ãŸ',
                'æŠ˜ã£ãŸ', 'æº¶ã‹ã—ãŸ', 'å‡ã‚‰ã›ãŸ', 'ç‡ƒã‚„ã—ãŸ', 'æ¶ˆã—ãŸ', 'ä½œã£ãŸ', 'å£Šã—ãŸ', 'ç›´ã—ãŸ',
                'å¤‰ãˆãŸ', 'æ··ãœãŸ', 'åˆ†ã‘ãŸ', 'é›†ã‚ãŸ', 'æ•£ã‚‰ã—ãŸ', 'éš ã—ãŸ', 'è¦‹ã¤ã‘ãŸ', 'å¤±ã£ãŸ',
                'æ•°ãˆãŸ', 'æ¸¬ã£ãŸ', 'æã„ãŸ', 'æ­Œã£ãŸ', 'è¸Šã£ãŸ', 'è·³ã­ãŸ', 'è»¢ãŒã—ãŸ', 'é£›ã°ã—ãŸ',
                'æ²ˆã‚ãŸ', 'æµ®ã‹ã¹ãŸ', 'å‰Šã£ãŸ', 'ç£¨ã„ãŸ', 'å¡—ã£ãŸ', 'å‰¥ãŒã—ãŸ', 'è²¼ã£ãŸ', 'çµã‚“ã ',
                'è§£ã„ãŸ', 'é–‹ã„ãŸ', 'é–‰ã˜ãŸ', 'ç¹‹ã’ãŸ', 'åˆ‡ã£ãŸ', 'æŠ˜ã‚Šç•³ã‚“ã ', 'åºƒã’ãŸ', 'è©°ã‚ãŸ'
            ];
            
            static consequences = [
                'ãã®çµæœã€ä¸–ç•ŒãŒ', 'ã™ã‚‹ã¨ã€æ™‚é–“ãŒ', 'ãã—ã¦ã€ç©ºé–“ãŒ', 'ãªãœã‹ã€é‡åŠ›ãŒ',
                'çªç„¶ã€è‰²ãŒ', 'ä¸æ€è­°ãªã“ã¨ã«ã€éŸ³ãŒ', 'ãã®ç¬é–“ã€å…‰ãŒ', 'é©šãã¹ãã“ã¨ã«ã€å½±ãŒ',
                'ãã®å½±éŸ¿ã§ã€é¢¨ãŒ', 'å¥‡å¦™ãªã“ã¨ã«ã€æ°´ãŒ', 'äºˆæƒ³å¤–ã«ã€ç«ãŒ', 'ä¿¡ã˜ã‚‰ã‚Œãªã„ãŒã€æ°·ãŒ',
                'ãã®çµæœã€é›²ãŒ', 'ãªã‚“ã¨ã€æ˜ŸãŒ', 'ãã®ã›ã„ã§ã€æœˆãŒ', 'ä¸å¯è§£ã«ã‚‚ã€å¤ªé™½ãŒ',
                'ãã®ç¬é–“ã€è¨˜æ†¶ãŒ', 'çªå¦‚ã¨ã—ã¦ã€å¤¢ãŒ', 'ãã®æ™‚ã€ç¾å®ŸãŒ', 'é©šã„ãŸã“ã¨ã«ã€æœªæ¥ãŒ'
            ];
            
            static results = [
                'é€†ã•ã¾ã«ãªã£ãŸ', 'æ¶ˆãˆã¦ã—ã¾ã£ãŸ', 'äºŒå€ã«ãªã£ãŸ', 'åŠåˆ†ã«ãªã£ãŸ', 'é€æ˜ã«ãªã£ãŸ',
                'è™¹è‰²ã«ãªã£ãŸ', 'è¸Šã‚Šå§‹ã‚ãŸ', 'æ­Œã„å§‹ã‚ãŸ', 'ç¬‘ã„å‡ºã—ãŸ', 'æ³£ãå‡ºã—ãŸ',
                'é£›ã³è·³ã­ãŸ', 'å›è»¢ã—ãŸ', 'æº¶ã‘ãŸ', 'å‡ã£ãŸ', 'ç‡ƒãˆãŸ', 'å…‰ã£ãŸ', 'çˆ†ç™ºã—ãŸ',
                'åˆ†è£‚ã—ãŸ', 'èåˆã—ãŸ', 'å¤‰èº«ã—ãŸ', 'é€²åŒ–ã—ãŸ', 'é€€åŒ–ã—ãŸ', 'å·¨å¤§åŒ–ã—ãŸ', 'ç¸®å°ã—ãŸ',
                'åŠ é€Ÿã—ãŸ', 'åœæ­¢ã—ãŸ', 'é€†å†ç”Ÿã•ã‚ŒãŸ', 'ãƒ«ãƒ¼ãƒ—ã—ãŸ', 'åˆ†å²ã—ãŸ', 'åæŸã—ãŸ',
                'åè»¢ã—ãŸ', 'é¡é¢åŒ–ã—ãŸ', 'è¤‡è£½ã•ã‚ŒãŸ', 'æ¶ˆå»ã•ã‚ŒãŸ', 'ãƒªã‚»ãƒƒãƒˆã•ã‚ŒãŸ', 'ãƒã‚°ã£ãŸ',
                'æ¬¡å…ƒãŒä¸ŠãŒã£ãŸ', 'æ¬¡å…ƒãŒä¸‹ãŒã£ãŸ', 'é‡å­åŒ–ã—ãŸ', 'æ³¢å‹•åŒ–ã—ãŸ', 'ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã—ãŸ', 'ã‚¢ãƒŠãƒ­ã‚°åŒ–ã—ãŸ',
                'æ¶²ä½“åŒ–ã—ãŸ', 'æ°—ä½“åŒ–ã—ãŸ', 'å›ºä½“åŒ–ã—ãŸ', 'ãƒ—ãƒ©ã‚ºãƒåŒ–ã—ãŸ', 'è™šæ•°åŒ–ã—ãŸ', 'ç„¡é™åŒ–ã—ãŸ'
            ];
            
            static generateUniqueBehavior() {
                // å®Œå…¨ã«ãƒ©ãƒ³ãƒ€ãƒ ãªé †åºã§è¦ç´ ã‚’é¸æŠ
                const shuffledActions = TrueRandom.shuffle(this.actions);
                const shuffledObjects = TrueRandom.shuffle(this.objects);
                const shuffledMethods = TrueRandom.shuffle(this.methods);
                const shuffledConsequences = TrueRandom.shuffle(this.consequences);
                const shuffledResults = TrueRandom.shuffle(this.results);
                
                // ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°ã®å‹•è©ã‚’çµ„ã¿åˆã‚ã›ï¼ˆ1ã€œ3å€‹ï¼‰
                const actionCount = TrueRandom.int(1, 3);
                let behaviorText = '';
                
                for (let i = 0; i < actionCount; i++) {
                    const action = TrueRandom.choice(shuffledActions);
                    const object = TrueRandom.choice(shuffledObjects);
                    const method = TrueRandom.choice(shuffledMethods);
                    
                    behaviorText += action + object + method;
                    
                    if (i < actionCount - 1) {
                        const connectors = ['ã€ãã®å¾Œ', 'ã€åŒæ™‚ã«', 'ã€ãã—ã¦', 'ã€ã—ã‹ã—', 'ã€ã ã‹ã‚‰', 'ã€ã‚‚ã—ãã¯'];
                        behaviorText += TrueRandom.choice(connectors);
                    }
                }
                
                // çµæœã®è¿½åŠ ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã«0ã€œ2å€‹ï¼‰
                const consequenceCount = TrueRandom.int(0, 2);
                for (let i = 0; i < consequenceCount; i++) {
                    const consequence = TrueRandom.choice(shuffledConsequences);
                    const result = TrueRandom.choice(shuffledResults);
                    behaviorText += 'ã€‚' + consequence + result;
                }
                
                // ãƒ©ãƒ³ãƒ€ãƒ ãªè¿½åŠ è¦ç´ ï¼ˆ10%ã®ç¢ºç‡ã§ç™ºç”Ÿï¼‰
                if (TrueRandom.get() > 0.9) {
                    const bonus = [
                        'ï¼ˆã“ã‚Œã¯èª°ã‚‚è¦‹ãŸã“ã¨ãŒãªã„ç¾è±¡ã ï¼‰',
                        'ï¼ˆç†è«–ä¸Šã¯ä¸å¯èƒ½ãªã¯ãšã ï¼‰',
                        'ï¼ˆç‰©ç†æ³•å‰‡ã‚’ç„¡è¦–ã—ã¦ã„ã‚‹ï¼‰',
                        'ï¼ˆèª¬æ˜ãŒä¸€åˆ‡ã¤ã‹ãªã„ï¼‰',
                        'ï¼ˆç§‘å­¦ã§ã¯è§£æ˜ã§ããªã„ï¼‰',
                        'ï¼ˆå®‡å®™ã®æ³•å‰‡ãŒæ›¸ãæ›ã‚ã£ãŸï¼‰',
                        'ï¼ˆæ¬¡å…ƒã®å£ãŒå´©ã‚ŒãŸï¼‰',
                        'ï¼ˆæ™‚ç©ºã«æ­ªã¿ãŒç”Ÿã˜ãŸï¼‰',
                        'ï¼ˆå› æœå¾‹ãŒç ´ç¶»ã—ãŸï¼‰',
                        'ï¼ˆè¦³æ¸¬è€…åŠ¹æœãŒç™ºå‹•ã—ãŸï¼‰'
                    ];
                    behaviorText += TrueRandom.choice(bonus);
                }
                
                return behaviorText;
            }
            
            static getRandomAnimal() {
                return TrueRandom.choice(this.animals);
            }
            
            static getAnimalName() {
                const names = [
                    'è¬ã®ç”Ÿç‰©', 'æœªç¢ºèªå‹•ç‰©', 'å¹»ã®ç£', 'ä¼èª¬ã®å­˜åœ¨', 'å¥‡å¦™ãªç”Ÿãç‰©',
                    'ä¸æ€è­°ãªå‹•ç‰©', 'æƒ³åƒä¸Šã®ç”Ÿç‰©', 'ç•°ä¸–ç•Œã®ä½äºº', 'æ¬¡å…ƒã‚’è¶…ãˆãŸå­˜åœ¨', 'æ™‚ç©ºã‚’å½·å¾¨ã†è€…',
                    'é‡å­çš„ç”Ÿå‘½ä½“', 'éãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ç”Ÿç‰©', 'ã‚·ãƒ¥ãƒ¬ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼ã®å‹•ç‰©', 'æ³¢å‹•é–¢æ•°ã®åŒ–èº«', 'ç¢ºç‡çš„å­˜åœ¨'
                ];
                return TrueRandom.choice(names);
            }
        }
        
        // Three.js ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        
        camera.position.z = 5;
        
        // èƒŒæ™¯ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«
        const particleGeometry = new THREE.BufferGeometry();
        const particleCount = 500;
        const positions = new Float32Array(particleCount * 3);
        const colors = new Float32Array(particleCount * 3);
        
        for (let i = 0; i < particleCount; i++) {
            positions[i * 3] = TrueRandom.range(-20, 20);
            positions[i * 3 + 1] = TrueRandom.range(-20, 20);
            positions[i * 3 + 2] = TrueRandom.range(-20, 20);
            
            colors[i * 3] = TrueRandom.get();
            colors[i * 3 + 1] = TrueRandom.get();
            colors[i * 3 + 2] = TrueRandom.get();
        }
        
        particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        particleGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
        
        const particleMaterial = new THREE.PointsMaterial({
            size: 0.1,
            vertexColors: true,
            transparent: true,
            opacity: 0.6,
            blending: THREE.AdditiveBlending
        });
        
        const particleSystem = new THREE.Points(particleGeometry, particleMaterial);
        scene.add(particleSystem);
        
        // ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        
        const pointLight = new THREE.PointLight(0xffffff, 1, 100);
        pointLight.position.set(0, 0, 10);
        scene.add(pointLight);
        
        // å‹•ç‰©çµµæ–‡å­—ã®DOMè¦ç´ ç®¡ç†
        const animalElements = [];
        
        function createAnimalEmoji(emoji, behavior) {
            const element = document.createElement('div');
            element.className = 'animal-emoji';
            element.textContent = emoji;
            element.style.left = TrueRandom.range(10, 90) + '%';
            element.style.top = TrueRandom.range(10, 90) + '%';
            document.body.appendChild(element);
            
            // ãƒ©ãƒ³ãƒ€ãƒ ãªå‹•ãã®ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆ
            const duration = TrueRandom.range(2000, 4000);
            const rotations = TrueRandom.int(0, 4);
            const scale = TrueRandom.range(0.5, 2);
            const moveX = TrueRandom.range(-200, 200);
            const moveY = TrueRandom.range(-200, 200);
            
            element.animate([
                { 
                    transform: 'translate(0, 0) rotate(0deg) scale(0)',
                    opacity: 0
                },
                {
                    transform: `translate(${moveX/2}px, ${moveY/2}px) rotate(${rotations * 180}deg) scale(${scale})`,
                    opacity: 1,
                    offset: 0.3
                },
                {
                    transform: `translate(${moveX}px, ${moveY}px) rotate(${rotations * 360}deg) scale(${scale * 1.2})`,
                    opacity: 1,
                    offset: 0.7
                },
                {
                    transform: `translate(${moveX * 1.5}px, ${moveY * 1.5}px) rotate(${rotations * 540}deg) scale(0)`,
                    opacity: 0
                }
            ], {
                duration: duration,
                easing: 'cubic-bezier(' + [TrueRandom.get(), TrueRandom.get(), TrueRandom.get(), TrueRandom.get()].join(',') + ')'
            });
            
            animalElements.push(element);
            
            setTimeout(() => {
                element.remove();
                const index = animalElements.indexOf(element);
                if (index > -1) animalElements.splice(index, 1);
            }, duration);
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†
        let behaviorCount = 0;
        let isEventActive = false;
        
        function triggerBehavior() {
            if (isEventActive) return;
            
            isEventActive = true;
            behaviorCount++;
            
            // ãƒœã‚¿ãƒ³ã‚’éš ã™
            const button = document.getElementById('main-button');
            button.classList.add('hidden');
            
            // ãƒ©ãƒ³ãƒ€ãƒ ãªå‹•ç‰©ã¨è¡Œå‹•ã‚’ç”Ÿæˆ
            const animal = BehaviorGenerator.getRandomAnimal();
            const animalName = BehaviorGenerator.getAnimalName();
            const behavior = BehaviorGenerator.generateUniqueBehavior();
            
            // è¡¨ç¤ºã‚’æ›´æ–°
            const animalNameEl = document.getElementById('animal-name');
            const behaviorTextEl = document.getElementById('behavior-text');
            
            animalNameEl.textContent = animal + ' ' + animalName;
            behaviorTextEl.textContent = behavior;
            
            animalNameEl.classList.add('active');
            setTimeout(() => behaviorTextEl.classList.add('active'), 300);
            
            // èƒŒæ™¯è‰²å¤‰æ›´
            const hue1 = TrueRandom.int(0, 360);
            const hue2 = (hue1 + TrueRandom.int(30, 150)) % 360;
            document.body.style.background = `linear-gradient(${TrueRandom.int(0, 360)}deg, 
                hsl(${hue1}, 70%, 60%) 0%, 
                hsl(${hue2}, 70%, 60%) 100%)`;
            
            // è¤‡æ•°ã®å‹•ç‰©çµµæ–‡å­—ã‚’ç”Ÿæˆ
            const emojiCount = TrueRandom.int(5, 15);
            for (let i = 0; i < emojiCount; i++) {
                setTimeout(() => {
                    createAnimalEmoji(animal, behavior);
                }, i * 200);
            }
            
            // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã®è‰²ã‚’å¤‰æ›´
            const colors = particleSystem.geometry.attributes.color.array;
            for (let i = 0; i < particleCount; i++) {
                colors[i * 3] = TrueRandom.get();
                colors[i * 3 + 1] = TrueRandom.get();
                colors[i * 3 + 2] = TrueRandom.get();
            }
            particleSystem.geometry.attributes.color.needsUpdate = true;
            
            // ã‚«ãƒ¡ãƒ©ã®å‹•ã
            const cameraAnimation = [
                { z: 5, rotationZ: 0 },
                { z: 3, rotationZ: 0.2 },
                { z: 7, rotationZ: -0.2 },
                { z: 5, rotationZ: 0 }
            ];
            
            let step = 0;
            const cameraInterval = setInterval(() => {
                if (step < cameraAnimation.length) {
                    camera.position.z = cameraAnimation[step].z;
                    camera.rotation.z = cameraAnimation[step].rotationZ;
                    step++;
                } else {
                    clearInterval(cameraInterval);
                }
            }, 750);
            
            // 3ç§’å¾Œã«ãƒªã‚»ãƒƒãƒˆ
            setTimeout(() => {
                animalNameEl.classList.remove('active');
                behaviorTextEl.classList.remove('active');
                
                button.classList.remove('hidden');
                const buttonTexts = ['è¦³æ¸¬ã™ã‚‹', 'å®Ÿè¡Œã™ã‚‹', 'ç™ºå‹•ã™ã‚‹', 'èµ·ã“ã™', 'è¦‹ã‚‹', 'ç¢ºèªã™ã‚‹'];
                button.textContent = TrueRandom.choice(buttonTexts);
                
                const btnHue1 = TrueRandom.int(0, 360);
                const btnHue2 = (btnHue1 + TrueRandom.int(30, 100)) % 360;
                button.style.background = `linear-gradient(135deg, 
                    hsl(${btnHue1}, 80%, 65%) 0%, 
                    hsl(${btnHue2}, 80%, 60%) 100%)`;
                
                isEventActive = false;
            }, 3000);
        }
        
        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
        document.getElementById('main-button').addEventListener('click', triggerBehavior);
        document.getElementById('main-button').addEventListener('touchstart', (e) => {
            e.preventDefault();
            triggerBehavior();
        });
        
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—
        function animate() {
            requestAnimationFrame(animate);
            
            // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã®å›è»¢
            particleSystem.rotation.y += 0.001;
            particleSystem.rotation.x += 0.0005;
            
            renderer.render(scene, camera);
        }
        
        // ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // åˆæœŸåŒ–
        animate();
    </script>
</body>
</html>